# Введение в модуль

> **Цель курса** — подготовка к работе в области проведения расследований инцидентов и обеспечения реагирования. Курс направлен на формирование глубокого понимания принципов и методов сбора артефактов, их анализа и последующей интерпретации.

> **Основная задача курса** — сформировать представление о современных технологиях и инструментах, применяемых в области компьютерной криминалистики, включая анализ данных с цифровых носителей, работу с сетевыми артефактами, восстановление информации. В совокупности данные знания будут необходимы для проведения полноценного расследования или реагирования.

Для более эффективного освоения курса требуются следующие базовые навыки:
1. Базовое понимание принципов работы операционных систем.
1. Основы программирования.
1. Понимание основ компьютерных сетей.

## Обзор содержания курса

> Атакующий всегда будет на шаг впереди того, кто пытается защититься

- будет предложен определённый систематический подход, заключающийся в непрерывном обмене знаний между командами. 
- формирования понимания системы защиты, кто должен выполнять какую роль и в какой момент.

Основные вопросы, ответы на которые предстоит рассмотреть в первом модуле:

- Чем занимается специалист по компьютерной криминалистике.
- Чем отличается работа в SOC и DFIR.
- Почему важно обмениваться данными об угрозах.
- Может ли специалист DFIR работать в одиночку.
- Чем расследование отличается от реагирования.
- Существует ли ультимативное решение, способное защитить всех.

## Проблематика 1 модуля «Основы компьютерной криминалистики»

- **Как в большом объёме информации найти то, что необходимо для расследования, или как иголка в стоге сена помогает раскрывать преступления**
    - на что необходимо обращать внимание в первую очередь и почему
- **Что делать, если мы уверены, что на системе была активность злоумышленника, но её следы изначально не видны**
- **Как поступить, если необходима автоматизация при расследовании**

## Основные термины

**Чем занимается специалист по DFIR**: Исходя из названия, DFIR состоит из двух направлений: цифровая криминалистика (Digital Forensics) и реагирование на инциденты (Incident Response). 

### Реагирование на инциденты

Основная и первоначальная задача реагирования — исключить возможность развития инцидента. Специалисту необходимо оперативно определить, как можно локализовать инцидент. Главные вопросы, на которые необходимо ответить в начале проекта:
- Какие системы необходимо изолировать.
- Сохраняет ли на данный момент злоумышленник доступ к корпоративной сети.
- Какое вредоносное программное обеспечение было использовано и как его можно детектировать.
- Какие технические меры необходимо предпринять системным администраторам.

1. **Определение цели злоумышленника**<br>Специалисту необходимо на начальном этапе понять, какую атаку злоумышленник пытается провести и что может являться его конечной целью.
2. **Координация работы команда реагирования**<br>В случае, если реагирования производится несколькими командами, специалист по DFIR берёт на себя формирование общего плана реагирования.

### Цифровая криминалистика

1. **Сбор и анализ данных**<br>Исходя из инцидента, специалист определяет, какие данные необходимо собрать и как это можно сделать. В данный процесс может входить:
    - снятие образа диска,
    - сбор артефактов,
    - анализ собранных данных,
    - восстановление данных с различных носителей информации.
1. **Формирование полной картины инцидента**
    - Специалисту необходимо определить все действия злоумышленника и что являлось его конечной целью
    - Результатом данного процесса является timeline инцидента, матрица MITRE и Kill Chain.
1. **Формирование рекомендаций**
    - Специалисту необходимо сформировать список технических и организационных рекомендаций
    - Технические рекомендации – набор инструкций для TI подразделения, которые позволят в дальнейшем минимизировать риск повторения инцидента.

> **Организационные рекомендации** — инструкции для управляющего звена, как можно перестроить процессы, что можно внедрить

### Различия между DFIR и компьютерной криминалистикой в правоохранительной сфере

- по сути выполняют одну и ту же задачу — расследование инцидента
- Основные отличие
    - в правоохранительной сфере необходимо формировать доказательную базу согласно законодательству для последующего представления в суде.

# Основные идеи

## DFIR и SOC

### Security Operations Center (SOC)

Центр мониторинга Security Operations Center или SOC состоит из нескольких уровней аналитиков (L1, L2, L3)

- **L1**: обработка событий, отсечение легитимных событий, создание инцидента в случае обнаружения, анализ простых инцидентов.
- **L2**: аналогично L1, за исключением возможности анализа более сложных инцидентов. Соответственно, чем сложнее инцидент, тем дальше он будет эскалирован.
- **L3**: анализ сложных инцидентов. Формирование правил детектирования, аналитика.

Основные инструменты аналитика SOC — EDR, SIEM, IDS/IPS.

Основной задачей аналитика SOC является:
- обработка событий,
- выявление нелегитимных событий,
- реагирование на нелегитимные события, изоляция и нейтрализация вредоносной активности,
- создание правил детектирования.

### Digital Forensics and Incident Response (DFIR)

- специалист DFIR занимает реагирования и расследование с случае с исключительной высокой критичностью инцидента. К примеру, инцидент на начальном этапе был пропущен аналитиком SOC или если никакого мониторинга в принципе не было.
- специалисты DFIR по большей части умеют анализировать вредоносное программное обеспечение (Reverse engineering). Это необходимо в тех случаях, когда динамический и поведенческий анализ ВПО не даёт результатов.

### взаимодействие между командами

Когда SOC обнаруживает инцидент, он передаёт информацию и данные в команду DFIR для проведения детального расследования и реагирования.

В результате анализа инцидента DFIR передаёт SOC план для каждого из этапов реагирования. DFIR определяет, когда и какую активность необходимо нейтрализовать, какие системы необходимо изолировать, что необходимо зачистить и заблокировать.

## Endpoint Detection & Response (EDR)

**Решения типа EDR состоят из двух частей**
- Агент EDR, который будет установлен на систему.
- Сервер EDR, принимающий события от агента.

**основные задачи агента EDR делятся на категории**
- Сбор событий из подключённых источников на системе.
- Автоматическое или ручное реагирования в случае обнаружены угрозы

После отправки события от агента на сервер каждое событие автоматически анализируется на предмет наличия вредоносной активности

Как было оговорено ранее, данные правила формируют аналитики SOC

**необходимо обеспечить сбор событий и отправку их на сервер**<br>Первое, что необходимо сделать — проверить сетевую доступность до сервера от всех конечных систем, где предполагается развёртывание агента EDR

если некоторые системы полностью лишены доступа в глобальную сеть и функционируют исключительно в локальной сети, можно решить данную проблему следующим образом:

1. Proxy сервер внутри инфраструктуры, доступный для всех из локальной сети и имеющий возможность доступа в глобальную сеть.
1. Развёртывание сервера EDR внутри инфраструктуры. 

Второй вариант не является предпочтительным по следующим причинам:
- Повышает риск атаки на сервер EDR в случае серьёзного инцидента.
- Требование к характеристикам сервера крайне велики и не всегда могут быть полностью удовлетворены.
- Требуется организация отдельного доступа до сервера аналитикам SOC.

## Cyber threat intelligence

основная задача Cyber threat intelligence — сбор максимального количества данных о злоумышленнике.

Основные задачи могут быть сформулированы следующим образом:
- формирование базы знаний о существующих угрозах,
- формирование списка действий конкретных группировок,
- анализ ВПО,
- создание правил детектирования на основе анализа ВПО,
- формирование индикаторов компрометации,
- атрибуция группировок,
- формирование собственной платформы на основе базы знаний,
- создание Honeypot.

некоторые техники и приёмы, как можно обогатить базу знаний TI
- Сбор данных из открытых источников, к примеру, VirusTotal, malwarebazar.
- Данные, полученные в результате собственного сканирования.
- Обогащение за счёт пользователей услуг платформы TI, внешних заказчиков.

## Обмен данными между DFIR, SOC и TI

**Threat Intelligence (TI) передаёт в SOC и DFIR**
- данные о характерных действиях злоумышленника (MITRE, Kill Chain);
- данные об используемом ВПО;
- данные об инфраструктуре злоумышленника;
- данные об активности инфраструктуры;
- данные, полученные с Honeypot;
- данные, выработанные на основе собранной базы знаний.
**SOC передаёт в DFIR**
- данные об инциденте;
- данные об обнаруженной активности злоумышленника;
- собранные артефакты посредством EDR;
- информация о системах, полученная посредством EDR;
- собранные ретроспективные данные.
**DFIR передаёт в SOC и TI**
- новые IoC, выявленные в ходе анализа;
- техники и процедуры атакующих, обнаруженные в ходе расследования;
- отчёты о расследовании и реагировании.

